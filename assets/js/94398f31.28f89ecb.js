"use strict";(self.webpackChunkcloudshell_help=self.webpackChunkcloudshell_help||[]).push([[10297],{35684:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var n=s(17624),o=s(4552);const i={},r="Custom Script Development for Apps",l={id:"devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps/index",title:"Custom Script Development for Apps",description:"This article will take you through the development process of a custom script for CloudShell App deployment. CloudShell supports PowerShell scripts for Windows VMs, and bash or sh scripts for Linux VMs. When developing your script, we recommend you first simulate/debug it by running it manually on a similar machine.",source:"@site/docs/devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps/index.md",sourceDirName:"devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps",slug:"/devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps/",permalink:"/cloudshell-help/next/devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps/",draft:!1,unlisted:!1,editUrl:"https://github.com/QualiSystems/cloudshell-help/tree/main/docs/devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps/index.md",tags:[],version:"current",lastUpdatedAt:1715711019e3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Getting Started with Configuration Management Development",permalink:"/cloudshell-help/next/devguide/develop-config-management-scripts-for-apps/getting-started-with-cfg-mng-dev"},next:{title:"Add Your Script to an App",permalink:"/cloudshell-help/next/devguide/develop-config-management-scripts-for-apps/custom-script-dev-for-apps/add-script-to-app"}},p={},a=[{value:"Examples",id:"examples",level:2},{value:"Hello World",id:"hello-world",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Linux privilege escalation",id:"linux-privilege-escalation",level:3}];function d(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.M)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"custom-script-development-for-apps",children:"Custom Script Development for Apps"}),"\n",(0,n.jsx)(t.p,{children:"This article will take you through the development process of a custom script for CloudShell App deployment. CloudShell supports PowerShell scripts for Windows VMs, and bash or sh scripts for Linux VMs. When developing your script, we recommend you first simulate/debug it by running it manually on a similar machine."}),"\n",(0,n.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsx)(t.p,{children:"Here are several examples of custom scripts to help you get started. If you are new to script development, feel free to test them out."}),"\n",(0,n.jsx)(t.h3,{id:"hello-world",children:"Hello World"}),"\n",(0,n.jsxs)(t.p,{children:["A basic script, just to make sure we\u2019re communicating with the VM and are able to run a script. When run with an App, the output should be shown in the sandbox diagram\u2019s\xa0",(0,n.jsx)(t.strong,{children:"Output"}),"\xa0window."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-css",children:"Windows / Linux\necho \u201cHello World\u201c\n"})}),"\n",(0,n.jsx)(t.h3,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(t.p,{children:"A basic script that prints out the parameter defined in an App template or API call (see below). This is useful for debugging the script and making sure the parameter is received with the correct value. Note that the parameters are stored as environment variables on the App instance in the sandbox."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-css",children:"Windows\necho $env:P1\nLinux\necho $P1\n"})}),"\n",(0,n.jsx)(t.p,{children:"Specified in the App template:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Discovery Dialog",src:s(50076).c+"",width:"624",height:"164"})}),"\n",(0,n.jsx)(t.p,{children:"Specified in the ConfigureApps API method:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"Python\nfrom cloudshell.api.cloudshell_api import *\n \nsession = CloudShellAPISession('localhost', 'admin', 'admin', 'Global')\nsession.ConfigureApps(\n    reservationId='dfb2df41-334e-4630-8bc6-ec846eb072d6',\n    appConfigurations=[AppConfiguration('LinuxVmApp_9cb2-72d6', [ConfigParam('P1', 'Hello World From Here!')])],\n    printOutput=True\n)\n"})}),"\n",(0,n.jsxs)(t.admonition,{title:"Notes",type:"note",children:[(0,n.jsx)(t.p,{children:"Since this script uses parameters defined on the App template, it will not work when run manually outside of CloudShell. For this to work, you will need to edit the Python code as follows:"}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Update the CloudShell settings passed to the\xa0",(0,n.jsx)(t.code,{children:"session"}),"\xa0variable, if needed."]}),"\n",(0,n.jsxs)(t.li,{children:["Specify the ID of an active sandbox (in the\xa0",(0,n.jsx)(t.code,{children:"reservationId"}),"\xa0field of the Python code)."]}),"\n",(0,n.jsx)(t.li,{children:"Replace \u2018LinuxVmApp_9cb2-72d6\u2019 with the App\u2019s name."}),"\n"]})]}),"\n",(0,n.jsx)(t.h3,{id:"linux-privilege-escalation",children:"Linux privilege escalation"}),"\n",(0,n.jsx)(t.p,{children:"If the deployed App resource is set with the credentials of a \u201cregular\u201d user, you may specify the root credentials in the parameters (see the Parameters example above), to use them in the script."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-css",children:"Linux\necho $pass | su $user \u2013c \u2018ls /root\u2019\nor\nLinux\nsu - $user <<Block\n$pass\nls /root\nBlock\n"})})]})}function c(e={}){const{wrapper:t}={...(0,o.M)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},50076:(e,t,s)=>{s.d(t,{c:()=>n});const n=s.p+"assets/images/Custom-Scripts_2_624x164-3d58583ee5e2ebeb904abec274851df3.png"},4552:(e,t,s)=>{s.d(t,{I:()=>l,M:()=>r});var n=s(11504);const o={},i=n.createContext(o);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);
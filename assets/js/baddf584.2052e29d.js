"use strict";(self.webpackChunkcloudshell_help=self.webpackChunkcloudshell_help||[]).push([["24292"],{54236:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>s,toc:()=>c,default:()=>h,metadata:()=>o,assets:()=>l,contentTitle:()=>a});var o=JSON.parse('{"id":"devguide/enable-winrm-on-win-vm-for-cfg-mng","title":"Enable WinRM on Windows VMs to Support Configuration Management","description":"To allow the Execution Server to run configuration management on a Windows VM, you need to configure the Windows Remote Management (WinRM) service on the App\'s cloud provider VM. The configuration needs to be included in the VM\'s image or VM template. However, if the image doesn\'t include this configuration, you can specify a script that performs this configuration on the deployed VM, as explained below.","source":"@site/docs/devguide/enable-winrm-on-win-vm-for-cfg-mng.md","sourceDirName":"devguide","slug":"/devguide/enable-winrm-on-win-vm-for-cfg-mng","permalink":"/devguide/enable-winrm-on-win-vm-for-cfg-mng","draft":false,"unlisted":false,"editUrl":"https://github.com/QualiSystems/cloudshell-help/tree/main/docs/devguide/enable-winrm-on-win-vm-for-cfg-mng.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Passing Variables From the Setup Script to Configuration Management","permalink":"/devguide/develop-config-management-scripts-for-apps/passing-variables-to-cfg-mng"},"next":{"title":"Developing Custom Cloud Provider Shells","permalink":"/devguide/develop-custom-cloud-provider-shells"}}'),i=t(74848),r=t(84429);let s={sidebar_position:5},a="Enable WinRM on Windows VMs to Support Configuration Management",l={},c=[{value:"Related Topics",id:"related-topics",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"enable-winrm-on-windows-vms-to-support-configuration-management",children:"Enable WinRM on Windows VMs to Support Configuration Management"})}),"\n",(0,i.jsx)(n.p,{children:"To allow the Execution Server to run configuration management on a Windows VM, you need to configure the Windows Remote Management (WinRM) service on the App's cloud provider VM. The configuration needs to be included in the VM's image or VM template. However, if the image doesn't include this configuration, you can specify a script that performs this configuration on the deployed VM, as explained below."}),"\n",(0,i.jsx)(n.admonition,{title:"Notes",type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The below procedure explains how to configure WinRM over HTTP. If you want to configure WinRM to run over HTTPS, visit this ",(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/troubleshoot/windows-client/system-management-components/configure-winrm-for-https",children:"Microsoft Docs article"}),". WinRM over HTTPS only applies to custom scripts at this time. If WinRM is configured to run over HTTPS, the execution server will first try to run the custom script over HTTPS and then fall back to HTTP if HTTPS is unsuccessful. To prevent the fallback, set the ",(0,i.jsx)(n.strong,{children:"winrm_transport"})," parameter to ",(0,i.jsx)(n.strong,{children:"ssl"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["In CloudShell 8.0, we provide App Starter Packs that deploy Azure Windows VMs with this configuration. For details, contact ",(0,i.jsx)(n.a,{href:"http://support.quali.com/",children:"Quali Support"}),"."]}),"\n"]})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"To configure the connection:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the Windows VM, start the ",(0,i.jsx)(n.strong,{children:"Windows Remote Management"})," service and set the ",(0,i.jsx)(n.strong,{children:"Startup type"})," to ",(0,i.jsx)(n.strong,{children:"Automatic"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Run command-line as administrator."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Run each of the following commands separately (you may need to acknowledge the running of some of these commands in the process):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"winrm quickconfig\nwinrm set winrm/config/service '@{AllowUnencrypted=\"true\"}'\nwinrm set winrm/config/service/Auth '@{Basic=\"true\"}'\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"If you encounter an error message stating that these commands are invalid, consider trying the commands without the single quotes."})})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If the VM is not part of a domain, you need to make sure the deployed VM's newly created network is private. If the network is public, the firewall will not allow WinRM connections through."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Open the Windows ",(0,i.jsx)(n.strong,{children:"Local Security Policy"})," window (secpol.msc in Command-Line) ",(0,i.jsx)(n.strong,{children:"> Network List Manager Policies > Unidentified Networks"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"Location type"})," to ",(0,i.jsx)(n.strong,{children:"Private"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/admin/cloudshell-manage-dashboard/manage-app-templates/#adding-app-templates",children:"Adding App templates"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},84429:function(e,n,t){t.d(n,{R:()=>s,x:()=>a});var o=t(96540);let i={},r=o.createContext(i);function s(e){let n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunkcloudshell_help=self.webpackChunkcloudshell_help||[]).push([["49575"],{911:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>o,toc:()=>c,default:()=>u,metadata:()=>s,assets:()=>a,contentTitle:()=>l});var s=JSON.parse('{"id":"install-configure/linux-virtual-appliance/installation-procedure/create-es-from-docker","title":"Create Execution Server On Any Linux VM Using Docker","description":"Prerequisites:","source":"@site/versioned_docs/version-2024.1/install-configure/linux-virtual-appliance/installation-procedure/create-es-from-docker.md","sourceDirName":"install-configure/linux-virtual-appliance/installation-procedure","slug":"/install-configure/linux-virtual-appliance/installation-procedure/create-es-from-docker","permalink":"/2024.1/install-configure/linux-virtual-appliance/installation-procedure/create-es-from-docker","draft":false,"unlisted":false,"editUrl":"https://github.com/QualiSystems/cloudshell-help/tree/main/versioned_docs/version-2024.1/install-configure/linux-virtual-appliance/installation-procedure/create-es-from-docker.md","tags":[],"version":"2024.1","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Create the Linux Execution Server from a Script","permalink":"/2024.1/install-configure/linux-virtual-appliance/installation-procedure/create-es-from-script"},"next":{"title":"Post Installation","permalink":"/2024.1/install-configure/linux-virtual-appliance/post-installation"}}'),i=r(74848),t=r(84429);let o={sidebar_position:4},l="Create Execution Server On Any Linux VM Using Docker",a={},c=[{value:"Online Steps to Install Execution Server Using Docker",id:"online-steps-to-install-execution-server-using-docker",level:2},{value:"Offline Steps to Install Execution Server Using Docker",id:"offline-steps-to-install-execution-server-using-docker",level:2},{value:"Steps to Collect and Share Logs on Linux Using Docker",id:"steps-to-collect-and-share-logs-on-linux-using-docker",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"create-execution-server-on-any-linux-vm-using-docker",children:"Create Execution Server On Any Linux VM Using Docker"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Prerequisites:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Docker installed on any Docker supported Linux VM: ",(0,i.jsx)(n.a,{href:"https://docs.docker.com/engine/install/",children:"https://docs.docker.com/engine/install/"})]}),"\n",(0,i.jsx)(n.li,{children:"Quali Server 2024.1 or later"}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsx)(n.p,{children:'In the docker run command, we use "--name ExecutionServer" for the container name in order to provide additional commands for gathering logs and other optional steps.'})}),"\n",(0,i.jsx)(n.h2,{id:"online-steps-to-install-execution-server-using-docker",children:"Online Steps to Install Execution Server Using Docker"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Install Docker on your Linux Server machine"}),"\n",(0,i.jsxs)(n.li,{children:["Enable Docker IPv6 support:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create"})," a file /etc/docker/daemon.json:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo touch /etc/docker/daemon.json\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Edit"})," the file:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo nano /etc/docker/daemon.json\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Add"})," to it (you can use any valid IPv6 CIDR):","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'{\n"ipv6": true,\n"fixed-cidr-v6": "2001:db8:1::/64"\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Save"})," it"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Restart the Docker Service:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo systemctl restart docker\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Create an empty file named customer.config:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"touch ~/customer.config\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Run the latest version of Execution Server using Docker Hub:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'sudo docker run -d --name ExecutionServer --restart unless-stopped -p 5093:5093 -e PARAMS="IP Address,Username,Password,Name for ExectionServer" -v ~/customer.config:/opt/ExecutionServer/customer.config qualihub/executionserver\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:'Inside PARAMS="" you need to specify your Cloudshell server IP, Cloudshell Admin username, password, desirable name for the Execution Server. Example: -e PARAMS="192.168.25.4,admin,admin,ES-Docker"'})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If you want to specify the version, you can edit the end of the command to include the version number. Example: qualihub/executionserver:2024.1"}),"\n",(0,i.jsxs)(n.li,{children:["See what versions are available here: ",(0,i.jsx)(n.a,{href:"https://hub.docker.com/r/qualihub/executionserver/tags",children:"https://hub.docker.com/r/qualihub/executionserver/tags"})]}),"\n"]})}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsx)(n.li,{children:"Verify the new Execution Server is Online in CloudShell Portal > Manage > Execution Servers > Servers"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"(Optional)"})," After the first run, if you don't want your admin password to be available as an Env\nvariable inside the container, you can:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Verify that your customer.config file is filled with data from the first run."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo cat customer.config\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Stop the existing container"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker stop ExecutionServer\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Delete the existing container"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker rm ExecutionServer\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Run a new container with the command:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker run -d --name ExecutionServer --restart unless-stopped -p 5093:5093 -v ~/customer.config:/opt/ExecutionServer/customer.config qualihub/executionserver\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"In this case, all necessary information will be provided by the customer.config file. Be\naware that this should be the same file that you used for the first run!"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"offline-steps-to-install-execution-server-using-docker",children:"Offline Steps to Install Execution Server Using Docker"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Install Docker on your Linux Server machine"}),"\n",(0,i.jsxs)(n.li,{children:["Enable Docker Ipv6 support:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create"})," a file /etc/docker/daemon.json:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo touch /etc/docker/daemon.json\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Edit"})," the file:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo nano /etc/docker/daemon.json\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Add"})," to it (you can use any valid ipv6 cidr):","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'{\n"ipv6": true,\n"fixed-cidr-v6": "2001:db8:1::/64"\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Save"})," it"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Restart the Docker Service:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo systemctl restart docker\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["Download ",(0,i.jsx)(n.strong,{children:"Execution Server on Docker"})," for your CloudShell Version from our ",(0,i.jsx)(n.a,{href:"https://support.quali.com/hc/en-us/articles/231613247-CloudShell-Download-Center",children:"Download Center"})]}),"\n",(0,i.jsx)(n.li,{children:"Transfer the .tar file to your Linux Server machine"}),"\n",(0,i.jsx)(n.li,{children:"Load ES Docker Image:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker load < es-2024-1.tar\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"7",children:["\n",(0,i.jsx)(n.li,{children:"Create an empty file named customer.config:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"touch ~/customer.config\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"8",children:["\n",(0,i.jsx)(n.li,{children:"Run a Docker Container from the image with the command:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'sudo docker run -d --name ExecutionServer --restart unless-stopped -p 5093:5093 -e PARAMS="IP Address,Username,Password,Name for ExectionServer" -v ~/customer.config:/opt/ExecutionServer/customer.config quali/es-server:2024.1\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:'Inside PARAMS="" you need to specify your Cloudshell server IP, Cloudshell Admin username, password, desirable name for the Execution Server. Example: -e PARAMS="192.168.25.4,admin,admin,ES-Docker"'})}),"\n",(0,i.jsxs)(n.ol,{start:"9",children:["\n",(0,i.jsx)(n.li,{children:"Verify the new Execution Server is Online in CloudShell Portal > Manage > Execution Servers > Servers"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"(Optional)"})," After the first run, if you don't want your admin password to be available as an Env\nvariable inside the container, you can:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Verify that your customer.config file is filled with data from the first run."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo cat customer.config\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Stop the existing container"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker stop ExecutionServer\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Delete the existing container"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker rm ExecutionServer\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Run a new container with the command:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"sudo docker run -d --name ExecutionServer --restart unless-stopped -p 5093:5093 -v ~/customer.config:/opt/ExecutionServer/customer.config qualihub/executionserver\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"In this case, all necessary information will be provided by the customer.config file. Be\naware that this should be the same file that you used for the first run!"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"steps-to-collect-and-share-logs-on-linux-using-docker",children:"Steps to Collect and Share Logs on Linux Using Docker"}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Since log files are located in the docker container, the commands below will copy the logs out of the container then create an archive file for each log directory"}),"\n",(0,i.jsx)(n.li,{children:"Only step 1 and 2 are usually needed but if requested by support or R&D, please include the venv logs from step 3"}),"\n"]})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create an archive file from ",(0,i.jsx)(n.code,{children:"/opt/ExecutionServer/Logs/"})," with the command below:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'current_date=$(date +%Y-%m-%d) && mkdir ~/${current_date}-Logs && sudo docker exec ExecutionServer find /opt/ExecutionServer/Logs/ -mindepth 1 -maxdepth 1 -type d -name "*" -mtime -7 -print0 | sudo xargs -0 -I {} docker cp ExecutionServer:{} ~/${current_date}-Logs && tar -czvf ${current_date}-Logs.tar.gz ${current_date}-Logs && sudo rm -rf ~/${current_date}-Logs\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Create an archive file from ",(0,i.jsx)(n.code,{children:"/var/log/qualisystems/"})," with the command below:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'current_date=$(date +%Y-%m-%d) && mkdir ~/${current_date}-qualisystems && sudo docker exec ExecutionServer find /var/log/qualisystems/ -mindepth 1 -maxdepth 1 -type d -name "*" -mtime -7 -print0 | sudo xargs -0 -I {} docker cp ExecutionServer:{} ~/${current_date}-qualisystems && tar -czvf ${current_date}-qualisystems.tar.gz ${current_date}-qualisystems && sudo rm -rf ~/${current_date}-qualisystems\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"(Optional, only needed if specifically requested for Shell issues)"})," Create an archive file from ",(0,i.jsx)(n.code,{children:"/usr/share/QualiSystems/venv/"})," with the command below:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"current_date=$(date +%Y-%m-%d) && mkdir ~/${current_date}-venv && sudo docker exec ExecutionServer find /usr/share/QualiSystems/venv/ -mindepth 1 -maxdepth 1 -type d -mtime -7 -print0 | sudo xargs -0 -I {} docker cp ExecutionServer:{} ~/${current_date}-venv && tar -czvf ${current_date}-venv.tar.gz ${current_date}-venv && sudo rm -rf ~/${current_date}-venv\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Transfer your newly created archived files named *-Logs, *-qualisystems, and *-venv from your home directory and share them to whom it may concern"}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"If you're using a Windows machine to extract logs from the Linux execution server, we recommend using an SCP client to connect via SSH to the Linux execution server to browse though the logs. You can also transfer the files to a Windows machine in order to send them, if needed."})})]})}function u(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},84429:function(e,n,r){r.d(n,{R:()=>o,x:()=>l});var s=r(96540);let i={},t=s.createContext(i);function o(e){let n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);